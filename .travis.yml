language: generic
dist: xenial

before_install:
  - sudo apt-get update -qq

before_script:
  - sudo apt-get install -y dos2unix
  - dos2unix bootstrap.sh
  - bash bootstrap.sh

script:
  - sudo service index stop
  - node ./experiment-provisioner/nodejs_websocket/index.js > index.log 2>&1 &
  - pytest ./experiment-provisioner/test/test.py -s
  - cd docs; make html

after_script:
  - cd ../experiment-provisioner; python main.py --action=terminate
